import 'package:blockchain_utils/bip/monero/monero_base.dart';
import 'package:blockchain_utils/utils/binary/utils.dart';
import 'package:monero_dart/monero_dart.dart';
import 'package:test/test.dart';

void main() {
  _testProofIn();
}

void _testProofIn() {
  test("proof in", () {
    final tx = MoneroTransaction.deserialize(
      BytesUtils.fromHexString(
        "020002020010c5d49f0494cd1283e402eaa702bbb802f737fb1f9c51bc01bb12668111d403b501e006fa02ab067dba130d18814a1d861abf55c550bddf32a9bae72f3970392d1c7b714004020010f1d3d702c7a4c101aab60b92b60dab8a01fd63af8407bc4c9c0d91035de70b5ec501a201b5015fe268125124551d9a725fcea6e639767f229a1db2954b1cac42493184c6e42a090003077c5038d2b8cfe9195f83178dee39d012d32076647075323d462bb30a42b90eea00032505e525e78ece4799ebe3234a38cd8d2063f4f045a75bc4f84dcbc29bb183168d000325986a6dfa857f918a30c152d6e0530047928375590503d59cd5961ca5c67ef01c00032ed68b4460e15888f3a41b9af8ad90c6ab6874acb53697e32b24cf6c4fc0fc3b840003e8f7ac2ce62834e5cf6b6f9fbeeba097a778f93403e2a196b4bdc3a8507e07c8dc0003e6030217b825373493ce150f4b4e5f6f6a5cd0d829d5f62333d5ae2c28ead2688d00033690b8f6db281a7e3c47b4cc23122ecbf92a59ecd428fe4cd0614273d9449e8caf0003a21dfcd8b2973e6c9faa18b7e00f89ff9d61d434f1d160c4100d5ae7251a57a3170003c447b4372a94c921d32fbba2758fb5a4321b1d2d8066d966dfbcbf8cfffba3c00dc30201c47f2cb46aefdd79d4ec7a0c1136034838a8d3a78dbbb391b0778b4c42bf4b6b04098cce5847c5bb63d7292b055d497e3aab99d3e485732fc8f063a2afa0c927c0cd64739ff492e92b8db1a52b8003d53ece0bda7001a1e1ec4050d132e4588317e7531001296967d70df34fc8d9eb56da6c15a7e0902b1d6efe8469b5355bb25abd6345a4478dc36c33ec71f1c29721a676d1f0f4d74e77de70403becbefea196a70bba8a399a9a35a4c0b3af5f994ad12cf8ed927003a79bc114490ee01c91b511682f0e7cd6135d0deb799b9426fa38d74e65c2bbbdce9f72c98337b3befb0b721efc8885ff522e81c9504fb192c052ab9d0d7170303e5ff2c5b4dd5ace626e08376fa9d3928d4fb03bd54d4942eeaf607e46a91596f199e4338cad5b819aa305fe690771ff343832042409389c73f6d1e4b8421f34d8439ab3b2e71dc4ea5e020680aba78701d13127dcd46049cf1c34f9b300075f40ce38769a32244d2f892686eb89406933886641ec237100ed84b5fb09d607ab6ab8f2d7688673f9cc6561d33e6890a7d7e4d90f615214f1e544a798f176d4f5e7ed060f284c9ffdbeec28d7ace9db60ecafa92fe54a3b61f28e0946b958388a5bb091619e2477aa8dc83febe23de7167e8b80a34c059c33ef6acb78dd72f55cc5ee7d7eed6ea166aef9078353c05fb46dd23ab9ec5239719d43a4f8c73cef694fbd62749bf746eb2bd954959180894660583265aa72c12691a7ba79e862489fbb94556f2fd2149fbbbfc6e541459217a938a91d228a111cbb0c968d7816bfe47aa126343414f805943f080a1c4ee250cd4be420690054e590a79cd601abbcdb16ef617dceebfb26756752ce09b18c6e6beba73430739e9d2324639f5041864e21246d28ad814688961be61d6f43640e3acb8be163598fca109a691e43775d492cd3998b63525dff4d8bbb6770e54c1c9f2903a44fabd1a6e201bd5342b48072ebbd16d2101492bc1a425855e6151144de20a1ff7d0396fc8e52644b715046f4f933f83a59f538d5435f1ed51e055f87915dd7ef11de722f78c6569465066cb66d820a2818c256552376e96922c55e5931e2dfa69845069e9c4bcc433a84df5730dc5a581702b6b603ff1900770f1dec7aca83ff7fdbc1bc8b0c0dd355c40aba7f6982e403cb73b80060f4d27a80c533cb733dd5ef1a91c5210d593e8fd387583a3d8aa1eed8cbd9f82c0a67ee392123f9241f6e7384ebb450040a7a6e196ff57269464164c380152ec3ff12f73a46896394115b54fe8c5577da5408af852aea18c1c8b5a6bbb38f654070a2ea8a61d1440a9ad7c6ae2cf672ec874ef743cd25557526b8a7ff731ec69b105716e0d219d9f227c7d61f2310dc49717fc31f73844638396a85a048fd4095bf345ba64c83675addcec56fdc33eaf705798bb1ddf8e16bc3ed2235dc922833b7e038238477835095ee21cc0a6be35346a226afd3115bd278be35981777200a3d37d7f25802f9565bbc0e88396630b71abcdbe27a6e958f58b3065fb771918eff95df5346f19ac84949c389d6cc0343e1b1fabf4781d3098af62b413cd1474aec1b2b4c8988fa3e5a812adb59e02edad3c016d18da513b8e703e875d7344d0fa588e29a9a40fbb629877fefb4a1006ae4f63eb104c7954b0ed248df4b49b185db24ca01c993e989dff8146e176b5b651a0a7592f4f44afb65de90f1e2a4c0ce34cb46a81f4d013b34f0c2133caea67a3d994070a10b1c9a43132f9fe94909e1d1e61616afff0fc4f64b15a9bcd9f736d661432a589ed3ef9884cf29db33bf629a7456e9ae7c3080ad0880ea949fb08eb50a053d8871765c0ce8e3867f5a206bedd8612b63e56cce299de7823f9a35a814cf7d8533212fd9152475bb94b42638612f1daba7aa2073cd73cc0f1b62d2026c4abaa25ea6e046877e6d8dd646c3e0469ad73cb1b52ba08656ecd44b42b62d720005f4c22c8b4854886be081af83a041d65f0ea46d8eb790ff378e9bbdecb4446429f6799c43a193a70ff3bfb3cd2a0974e1a4f02ded980fefdda3ac0a2808d30ec750d84ed540f4229f8b2ba03d5c4de28e28196d67dad05a846f4cf1a5a7879d8dfe37e246dbe3d0e0b793abc4e91466f9552bb0c41511a47893dc63e8712b23a99aad267a93c7c0ee55067bc1a2f8bf7ff506629db5e8497559fe1326d74404ab9970ce7713c1263daa6010b9d90bcfd073bbb068277aed09cbeb36752d8a069c822930f7eaf890a7dd8a4c2f721e79779a1ca849e13d44692ea69c351b3c01927eeff6880be5844900be0534294a70c513d170ea012499db8cd8af5bb592008da6ce15fc78c4ea63b02b7d3d94eab7ccebf46b54e37d666a8b83c1626ae008465f6cf2561ca0e0293c3a5bd62d84e377e2f7a485c86ae01322cc234682fa08311fa8bd17cfbd35372bc341453176e9ccdd1556e4d7f03fdc6755cedfee1408d928d83618f5545ac551f8b65aa66f7a1d30d5c072861c57c12761162973b102b5cc3e84be97c508b77e8df9a372fc12b75439ffc1030219f3fd7655314232074d36d8863f996cfa6a7bb909a8af8b2f81d502bac522f83b8eea95401dcbc30213450f48a4adaf8102ac3c455eab93a4dd07ca57cd68ad58ca5a6e8ac1ddb502137673a743c584d34abe8e6537b5dad593772678e4c1d7a18ef96c8a6ca19c0aeebab429f807415c14bc625d24fae7ed9f7dd4cfed8bcc50e1dada1576c0bc07ff237535261ff7ad1649b9ff9a60fa1e654d12eb4a57078f105478ea43bd790be29483566d8262dac97fd1243924bf6dc531f0f3f015506065d031a4d3016c0e5bf76251d481991c053d5dd51c7c171a140ceb28d8723cd981df1d704b5de4010ba800095efe0ecc1593cf3765827b95a908041490e0870a81fcf31d3863280082c8a1750a9a60df6bd7463956c44fe3745d79384e33b0a07be52fe1634e415fe8afbe11c2e759493ef5a059749b6f010f5bb33cda32a8bfe58a2c97318f680dce3bd999f1c1e4a0a38d9daad56adc2f01551743163759492a8ac9c2602027047e9ba3a38f96b1fbfea6990f79290891de6f1841d45b75486deb09ef28eb8b0a8ad4692ef6ae78f33d4c518ed929dced8815be5844b22956754fd90527594b02c64f46c9b8faf8c52df70057136671eaf38d0dc4126de562c1475c5b2f5d4b0c35d901787e1b39f63d07996e220fcf8e6be6cfb29bb9c0d8b07984f45b9cf8098fbb3d282ca6e95075d8ec35b0d2be968af2346080c29f192098a6350357080be7786248d30bf7f6d8231896372a56617e2f6e7334abbe0457a230a8a1f5d504745dac8d9a70a4de454ef09f43822c6df27f76a7342777d7062e2ecdbab06506df42e43cd01feb1052a061a6c08ef24c0d2f17f250262c14e0e98475b8132302d041a89ecbaee76297fe2a027f29837d018906b3524a5df69c909e40c5d3540cf9d13043a78d9c9b1387b8fe88e2b710eca03b865af904ba1330d945afb488019254972063dc0c7e3d5d08ecd3b78959aee9eec8099d54921fff20261070f80ebfde64c36692ce5b17545250dadb4009bb7d6f87e76cc9825040e1d09b1d7d043badf4d3c015d5015bcd8fa3826e433196415042610f6d5f11581f615a424d0b7318fd0119c1c20df7e2efb175e8e7919c4346613de7acf6ef77f182aaa4400483cb36df28a4e8faa308b7e66b395d1e8de448ff8f213396057daa7d3db64e0a331f11f333890269bea4463737735b98dcaa2c7bd169f1471c60a133b9dffd8030ded0cd0484aec0b4658522f192b4f99ae099c24b27b68679ae11d9495edd659b740a89635cada250b7ef0d1a95bdab15ec0cb3a5d8e1bfbab33c4958abb953",
      ),
    );
    final amount = MoneroTransactionHelper.checkProofVar(
      transaction: tx,
      proofStr:
          "InProofV2ieSfX2y5UM5CVdsadXHqac6KVL6Vwr4MwGRNu4bSx7kJ9zuhU5BxPq6eBEFmycg542ffmasDJYNongEfvLRGm4jFN4AR5r1dd57JhEryAjV8SpDxBBDQZck3vQPVNHTyx1AdaoRoSYaRqY2iXetWQSDhmcXL25eBWjRjiDQvZtfudop9BKP5akDMaLk4a9Sif1xJiXY2ChkbjcbEMRvUfsZ91SRRCtiYpMk3d77g7C6xWQcCKQBP3DkSpsqUESgc6ZUz3MzN7bBnG1fLegG71UaWPyt3aDD2DtGEHruJgGyhuG7mJ1jBKzgjFxaCsb6aL9Am4EJYvCLjogxcC9LYNKcLWjDwcAe6ffegrpMym515weyAMoavWGRZYzCje8vxAirty5gxptS3CL4buzRJnfaZLqE4WkH9TYKXncE26jrAxAeFRC8sX5MATrFpj5Wb2AkBp6kqkqu2aSdJDyuf4o17YNTZJAgchgE9DHmiwqCrktajGi27D5wJD6RpY6D73sSE64xWxGfPozoBRQUzR7kPuSm2ppCPLEWED4ciPx3e9Py3BA8pjmXvu6m7DGCxMvcVYtC1fafcM5KUdWBfUzdbPRuwrNDBth6WoijbUVqm2BpcZ1HB7cTUyqXcchcWzVusojB5EJmYsYtW35fZSyBPYyU3KMih2CsLEuRaaPMZk5ZLBnQ39FKgyaQFYUs355MC3PxiHssDFWNnSvN7axcNbWm9Wofi4DewyBuvzQGj9ZV3kJ6wrZjXiZm3EXmYKJeipa4nfXocShHGJnvk7cME3SiWriF2rByKNro1z6UtzcGr7TbpdamgiMwjySCqe4ZpdDMSs3urAiaGhQSTCGjjkMJco4viYu2y6R1WVcu1qkhfNPkqzQLYNGtb14Aot13Xty4qNNxbYydXV83xCC3bLvTX6rvQKdJuxgNAXWdpfiBNff4rh8sr2NcD26oxrCDyjqaWd2u4t4tanRgVN8wGePAU4Y2bvTEDkHa4jhD4f1n7Qc9o4WFqA1geR4sgA8UoYkJXqgGDCv9FmFSA97d6DYCzhc8RTkf16XfUuKKKoAkR55LpXmWCJ7izT1zkJQRGDPckMPrYNg7QGAprT2s46uH6rDqgBf6aCyDhzU8SkKDGwgDQ4k95A8tw57NgsnDFCP1jQHUwVkK7qhRe11o8rjYy9esfifnpc72WqnWDamUBCrNHXLks8s5RZnaGUVz3GC6Bw9AZ8sK4PdRP5ghttQe8WdsTQsS1QNVj5G7jHfw5hUwoCEAAdMxyfrNHY4TvJeJHfQTEdQdSAV6t4zJvqk35dTgJeqcA2hZ9",
      message: '',
      address: MoneroAddress(
        "59jj2nxPKab3ZMEVyrUNuUMzgQ1WHjkWL5T6Xk7QaTszggbtPbRPEkZQau9yACYEmUCHPNrU2MBdnJf4s4xLK5AyLCXK8pS",
      ),
    );
    expect(amount, BigInt.parse("100000000000"));
    final account = MoneroAccount.fromPrivateSpendKey(
      BytesUtils.fromHexString(
        "e1ea47c6bc0fb14072d1b0fc2b55f515c9397a4f8015368df23de1fa1cc31b0e",
      ),
    );
    final gn = MoneroTransactionHelper.generateInProof(
      transaction: tx,
      account: account,
      index: const MoneroAccountIndex(),
    );
    final amount2 = MoneroTransactionHelper.checkProofVar(
      transaction: tx,
      proofStr: gn.toBase58(),
      address: MoneroAddress(
        "59jj2nxPKab3ZMEVyrUNuUMzgQ1WHjkWL5T6Xk7QaTszggbtPbRPEkZQau9yACYEmUCHPNrU2MBdnJf4s4xLK5AyLCXK8pS",
      ),
    );
    expect(amount2, BigInt.parse("100000000000"));
  });
}
